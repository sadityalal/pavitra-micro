{% extends "base.html" %}

{% block title %}Edit Address - Pavitra Enterprises{% endblock %}

{% block content %}
<!-- Page Title -->
<div class="page-title light-background">
  <div class="container d-lg-flex justify-content-between align-items-center">
    <h1 class="mb-2 mb-lg-0">Edit Address</h1>
    <nav class="breadcrumbs">
      <ol>
        <li><a href="{{ url_for('shop.index') }}">Home</a></li>
        <li><a href="{{ url_for('shop.account') }}">Account</a></li>
        <li><a href="{{ url_for('shop.account') }}">Addresses</a></li>
        <li class="current">Edit Address</li>
      </ol>
    </nav>
  </div>
</div>

<!-- Edit Address Section -->
<section class="edit-address section">
  <div class="container" data-aos="fade-up" data-aos-delay="100">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show mb-4" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Edit Address</h5>
          </div>
          <div class="card-body">
            <form method="POST" action="{{ url_for('shop.edit_address', address_id=address.id) }}">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
              <div class="row g-3">
                <!-- Contact Information -->
                <div class="col-md-6">
                  <label for="full_name" class="form-label">Full Name *</label>
                  <input type="text" class="form-control" id="full_name" name="full_name" value="{{ address.full_name }}" required>
                </div>
                <div class="col-md-6">
                  <label for="phone" class="form-label">Phone Number *</label>
                  <input type="tel" class="form-control" id="phone" name="phone" value="{{ address.phone }}" pattern="[0-9]{10}" required>
                  <div class="form-text">10-digit number without country code</div>
                </div>

                <!-- Address Information -->
                <div class="col-12">
                  <label for="address_line1" class="form-label">Address Line 1 *</label>
                  <input type="text" class="form-control" id="address_line1" name="address_line1" value="{{ address.address_line1 }}" required>
                </div>
                <div class="col-12">
                  <label for="address_line2" class="form-label">Address Line 2</label>
                  <input type="text" class="form-control" id="address_line2" name="address_line2" value="{{ address.address_line2 or '' }}">
                </div>
                <div class="col-12">
                  <label for="landmark" class="form-label">Landmark</label>
                  <input type="text" class="form-control" id="landmark" name="landmark" value="{{ address.landmark or '' }}">
                </div>

                <!-- Location Information -->
                <div class="col-md-6">
                  <label for="city" class="form-label">City *</label>
                  <input type="text" class="form-control" id="city" name="city" value="{{ address.city }}" required>
                </div>
                <div class="col-md-6">
                  <label for="state" class="form-label">State *</label>
                  <input type="text" class="form-control" id="state" name="state" value="{{ address.state }}" required>
                </div>
                <div class="col-md-6">
                  <label for="postal_code" class="form-label">PIN Code *</label>
                  <input type="text" class="form-control" id="postal_code" name="postal_code" value="{{ address.postal_code }}" pattern="[0-9]{6}" required>
                </div>
                <div class="col-md-6">
                  <label for="country" class="form-label">Country *</label>
                  <input type="text" class="form-control" id="country" name="country" value="{{ address.country }}" required>
                </div>

                <!-- Address Type -->
                <div class="col-md-6">
                  <label for="address_type" class="form-label">Address Type</label>
                  <select class="form-select" id="address_type" name="address_type">
                    <option value="shipping" {% if address.address_type == 'shipping' %}selected{% endif %}>Shipping Address</option>
                    <option value="billing" {% if address.address_type == 'billing' %}selected{% endif %}>Billing Address</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="address_type_detail" class="form-label">Address For</label>
                  <select class="form-select" id="address_type_detail" name="address_type_detail">
                    <option value="home" {% if address.address_type_detail == 'home' %}selected{% endif %}>Home</option>
                    <option value="work" {% if address.address_type_detail == 'work' %}selected{% endif %}>Work</option>
                    <option value="other" {% if address.address_type_detail == 'other' %}selected{% endif %}>Other</option>
                  </select>
                </div>

                <!-- Default Address -->
                <div class="col-12">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="is_default" name="is_default" value="true" {% if address.is_default %}checked{% endif %}>
                    <label class="form-check-label" for="is_default">
                      Set as default address
                    </label>
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="col-12">
                  <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">Update Address</button>
                    <a href="{{ url_for('shop.account') }}" class="btn btn-secondary">Cancel</a>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}